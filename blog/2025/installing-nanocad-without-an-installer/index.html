<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <blockquote> <p>[!WARNING] Все ниже написанное Вы повторяете на свой страх и риск<br> Статья ни в коем случае не является призывом к чему бы то ни было, <br> но если больше никак, то можно и так <br> Информация опубликована в ознакомительных целях</p> </blockquote> <blockquote> <p>[!Note] Нанокад разработка иногда балует пользователей <strong>Beta</strong> версиями своего чудесного nanoCAD`а.<br> Для меня участие в тестировании вопрос принципиальный, ибо пока еще верю,<br> что сообщая разработчику о багах, приближаю тот светлый день, когда nanoCAD станет если не идеальным,<br> то хотя бы лучшим CAD’ом всех времен и народов, ну или в нем будет меньше невынужденных ошибок</p> </blockquote> <blockquote> <p>[!IMPORTANT] Все ниже написанное должно получиться если на машине уже установлены:</p> <ul> <li>nanoCAD предыдущей версии, желательно не сильно древней (максимум на мажор минор младше)</li> <li>PostgreSQL и (или) SQLlite</li> </ul> </blockquote> <h3 id="для-чего-этот-вот-все">Для чего этот вот все?</h3> <p>Служба ИТО предприятия не то что бету тестовую, нужный рабочий софт установить или обновить не допросишься.<br> Поэтому все приходится делать самому.</p> <h4 id="что-надо">Что надо?</h4> <ul> <li>дистрибутив nanoCAD</li> <li>доступ к Regedit и в ветку в <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER</code> </li> <li>донор - компьютер на котором у нас есть права админа или виртуальная машина</li> <li>возможность скопировать на машину - реципиента файлы с донора</li> <li>прямые руки и не бояться, сломать все равно ничего не выйдет</li> </ul> <p>Если все это в наличии, читаем дальше</p> <h4 id="что-делать">Что делать?</h4> <p>на примере nanoCAD <strong>25.1</strong></p> <ol> <li>Инсталлируем nanoCAD на машине на которой у нас есть права</li> <li>По одному разу запускаем все модули, платформу, СПДС, Механику.</li> <li>Закрываем nanoCAD’ы</li> <li>Открываем редактор реестра <code class="language-plaintext highlighter-rouge">Regedit</code> и экспортируем ветку реестра <code class="language-plaintext highlighter-rouge">HKEY_CURRENT_USER\SOFTWARE\Nanosoft\nanoCAD x64\25.1</code> </li> <li>Идем в <code class="language-plaintext highlighter-rouge">c:\Users\Default\Desktop\</code> копируем ярлычки <em>СПДС</em> и <em>Механики</em> (ярлык платформы не нужен)</li> </ol> <p>С донора копируем каталоги:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">%AppData%\Roaming\Nanosoft\nanoCAD x64 25.1\</code> на реципиента в аналогичный каталог <code class="language-plaintext highlighter-rouge">%AppData%\Roaming\Nanosoft\nanoCAD x64 25.1\</code> </li> <li> <code class="language-plaintext highlighter-rouge">%ProgramData%\Nanosoft\nanoCAD x64 25.1\</code> на реципиента в аналогичный каталог <code class="language-plaintext highlighter-rouge">%ProgramData%\Nanosoft\nanoCAD x64 25.1\</code> </li> <li> <code class="language-plaintext highlighter-rouge">%ProgramFiles%\Nanosoft\nanoCAD x64 25.1\</code> в любой каталог реципиента, нежелательны длинные пути с кириллицей и пробелами (с кириллицей и пробелами то же получится, но мало ли)</li> </ul> <blockquote> <p>я скопировал сюда <code class="language-plaintext highlighter-rouge">d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\</code></p> </blockquote> <ul> <li>пути в реестре для <code class="language-plaintext highlighter-rouge">%AppDAta%</code> меняем на реальные <br> открываем в текстовом редакторе наш сохраненный в п.4 *.reg, выполняем поиск и замену:</li> </ul> <table> <thead> <tr> <th>Что меняем</th> <th>На что меняем</th> </tr> </thead> <tbody> <tr> <td>путь к моему профилю на доноре</td> <td>путь к моему профилю на реципиенте</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">C:\\Users\\dRz\\</code></td> <td><code class="language-plaintext highlighter-rouge">c:\\Users\\razygraevaa\\</code></td> </tr> </tbody> </table> <ul> <li> <p>сохраняем файл реестра, закрываем блокнот</p> </li> <li> <p>двойным кликом по *.reg отправляем данные в реестр реципиента</p> </li> </ul> <p>на этом подготовка закончена</p> <h3 id="как-запустить-нану">Как запустить нану</h3> <p>Редактируем ярлыки из п.5 , прописываем в них правильные пути до <code class="language-plaintext highlighter-rouge">nCadS.exe</code>, <code class="language-plaintext highlighter-rouge">nCadM.exe</code><br> Для <code class="language-plaintext highlighter-rouge">nCad.exe</code> проще сделать новый ярлык</p> <blockquote> <p>[!TIP] с такого батника запускаю СПДС</p> <div class="language-bat highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nl">:loop</span>
<span class="s2">"d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\nCadS.exe"</span> <span class="na">-b </span><span class="kd">nSPDSComp</span> <span class="na">-r </span><span class="kd">SPDS</span> <span class="na">-a </span><span class="kd">nanoCAD_x64_SPDS_25</span>.1 <span class="na">-oleid </span><span class="o">{</span><span class="m">729</span><span class="kd">C2166</span><span class="na">-C</span><span class="m">825</span><span class="o">-</span><span class="m">455</span><span class="kd">C</span><span class="o">-</span><span class="m">80</span><span class="kd">F0</span><span class="o">-</span><span class="m">5</span><span class="kd">E5F48C23E8E</span><span class="o">}</span>
<span class="c">REM pause</span>
<span class="k">goto</span> <span class="kd">loop</span>
</code></pre></div> </div> <p>удобно, один нана упал, сразу новый поднимается))</p> </blockquote> <p>Запускаем с ярлыков nanoCAD`ы, донастраиваем, под себя.</p> <blockquote> <p>[!IMPORTANT] если возникнут сложности с подключением к nanoCAD’у …</p> <ul> <li>Excel</li> <li>проблемы vla vlax</li> <li>и прочие непонятки с COM</li> </ul> <p>зарегистрировать COM сервер nanoCAD<br> открываем командную строку</p> <p>на примере СПДС, для других модулей аналогично<br> выполняем команду</p> <div class="language-bat highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="s2">"d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\nCadS.exe"</span> <span class="na">/register
</span></code></pre></div> </div> </blockquote> <blockquote> <p>[!Note] а что же делать с отсутствующей веткой <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Nanosoft\nanoCAD x64\25.1</code> <br> воскликнет пытливый читатель?<br> Да ничего ответит писатель, максимальный глюк и неудобство это то что нана будет неправильно показывать номер свой сборки в окне о программе ))</p> </blockquote> <blockquote> <p>[!IMPORTANT] update 31.07.2025<br> Специально проверил<br> Свежеустановленную сборку переместил на другой диск, в другой каталог<br> Все стартует запускается, как часы<br> Думаю это не моя заслуга , а linux для простоты работы под вайном, нанокад с легкостью ищет нужное вокруг себя по относительным путям</p> </blockquote> <blockquote> <p>[!Note] у nanoCAD все уже есть для того что бы стать полноценным портабле, но<br> nanoCAD без путей не понимает где искать</p> <ul> <li> <code class="language-plaintext highlighter-rouge">UserDataDir</code> -пользовательский каталог с настройками</li> <li> <code class="language-plaintext highlighter-rouge">CorpOptions.xml</code> - корпоративные настройки мультикад для платформы, СПДС и Механики</li> <li> <code class="language-plaintext highlighter-rouge">LogFile</code> - куда вести лог</li> <li> <code class="language-plaintext highlighter-rouge">ToolbarSettings</code> - настройки панелей, положение видимость и т.п. -<code class="language-plaintext highlighter-rouge">AppOptions.xml</code> - настройки мультикад для платформы, СПДС и Механики <blockquote> <p>без <code class="language-plaintext highlighter-rouge">AppOptions.xml</code> крашится настройка оформления и все с ней связанное…</p> <ul> <li>подключение к БД</li> <li>масштабы</li> <li>возможно, что то еще</li> </ul> </blockquote> </li> </ul> <p>Поэтому приходится редактировать реестр</p> </blockquote> <p><a name="problems"></a></p> <h2 id="возможные-проблемы-и-решения">Возможные проблемы и решения</h2> <h3 id="в-nanocad-не-открываются-настройки-оформления-в-списке-масштабов-странное-число">В nanoCAD не открываются настройки оформления, в списке масштабов странное число…</h3> <p>скорей всего не загрузился <code class="language-plaintext highlighter-rouge">AppOptions.xml</code><br> Причин всего две нет записи в реестре с путем к этому файлу <br> на примере СПДС<br> этой записи нет:</p> <pre><code class="language-reg">[HKEY_CURRENT_USER\SOFTWARE\Nanosoft\nanoCAD x64\25.1\NanoSPDS\MCSParams]
"SPDS.AppOptions_ru-RU"="D:\\setup\\nCAD\\SPDS.AppOptionsNana.xml"
</code></pre> <p>Запись в реестре есть, нет файла по этому пути<br> Проверку рекомендую начать с реестра, если параметра нет, <br> то создаем строковый параметр со значением путь до реального файла AppOptions.xml<br> <br> Если нет файла <code class="language-plaintext highlighter-rouge">AppOptions.xml</code>, <br> взять этот файл и другие недостающие (например для СПДС) можно в <code class="language-plaintext highlighter-rouge">%ProgramData%\Nanosoft\nanoCAD x64 25.1\NanoSPDS\UserTemplates\ru-RU\</code></p> </body></html>