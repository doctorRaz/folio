---
layout: post
title: a post with plotly.js
date: 2025-08-05 08:04:00
description: this is what included plotly.js code could look like
tags: install nanoCAD 
categories: sample-posts
chart:
  plotly: true
---

> [!WARNING]
Все ниже написанное Вы повторяете на свой страх и риск\
Статья ни в коем случае не является призывом к чему бы то ни было, \
но если больше никак, то можно и так \
Информация опубликована в ознакомительных целях

> [!Note]
Нанокад разработка иногда балует пользователей **Beta** версиями своего чудесного nanoCAD`а.\
Для меня участие в тестировании вопрос принципиальный, ибо пока еще верю,\
что сообщая разработчику о багах, приближаю тот светлый день, когда nanoCAD станет если не идеальным,\
то хотя бы лучшим CAD'ом всех времен и народов, ну или в нем будет меньше невынужденных ошибок

> [!IMPORTANT]
Все ниже написанное должно получиться если на машине уже установлены:
> -  nanoCAD предыдущей версии, желательно не сильно древней (максимум на мажор минор младше)
> - PostgreSQL и (или) SQLlite

### Для чего этот вот все?

Служба ИТО предприятия не то что бету тестовую, нужный рабочий софт установить или обновить не допросишься.\
Поэтому все приходится делать самому.

#### Что надо?

- дистрибутив  nanoCAD
- доступ к Regedit и в ветку в `HKEY_CURRENT_USER` 
- донор - компьютер на котором у нас есть права админа или виртуальная машина 
- возможность скопировать на машину - реципиента файлы с донора
- прямые руки и не бояться, сломать все равно ничего не выйдет

Если все это в наличии, читаем дальше

#### Что делать?

на примере nanoCAD **25.1**

1. Инсталлируем  nanoCAD на машине на которой у нас есть права
2. По одному разу запускаем все модули, платформу, СПДС, Механику.
3. Закрываем nanoCAD'ы
4. Открываем редактор реестра `Regedit` и экспортируем ветку реестра `HKEY_CURRENT_USER\SOFTWARE\Nanosoft\nanoCAD x64\25.1`
5. Идем в `c:\Users\Default\Desktop\` копируем ярлычки _СПДС_ и _Механики_ (ярлык платформы не нужен)

 С донора копируем каталоги:
 - `%AppData%\Roaming\Nanosoft\nanoCAD x64 25.1\` на реципиента в аналогичный каталог `%AppData%\Roaming\Nanosoft\nanoCAD x64 25.1\`
-  `%ProgramData%\Nanosoft\nanoCAD x64 25.1\` на реципиента в аналогичный каталог `%ProgramData%\Nanosoft\nanoCAD x64 25.1\`
 - `%ProgramFiles%\Nanosoft\nanoCAD x64 25.1\` в любой каталог реципиента, нежелательны длинные пути с кириллицей и пробелами (с кириллицей и пробелами то же получится, но мало ли) 
 
> я скопировал сюда `d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\` 

  - пути в реестре для `%AppDAta%` меняем на реальные \
  открываем в текстовом редакторе наш сохраненный в п.4 \*.reg, выполняем поиск и замену:
  
  |Что меняем|На что меняем|
  |---|---|
  |путь к моему профилю на доноре |путь к моему профилю на реципиенте|
  |`C:\\Users\\dRz\\` |`c:\\Users\\razygraevaa\\`|
  
- сохраняем файл реестра, закрываем блокнот

- двойным кликом по \*.reg отправляем данные в реестр реципиента

на этом подготовка закончена
 
### Как запустить нану

Редактируем ярлыки из п.5 , прописываем в них правильные пути до `nCadS.exe`, `nCadM.exe`\
Для `nCad.exe` проще сделать новый ярлык


> [!TIP]
> с такого батника запускаю СПДС
> 
> ```bat
> :loop
> "d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\nCadS.exe" -b nSPDSComp -r SPDS -a nanoCAD_x64_SPDS_25.1 -oleid {729C2166-C825-455C-80F0-5E5F48C23E8E}
> REM pause
> goto loop
> ```
> удобно, один нана упал, сразу новый поднимается))

Запускаем с ярлыков nanoCAD`ы, донастраиваем, под себя.

> [!IMPORTANT]
> если возникнут сложности с подключением к nanoCAD'у ...
> - Excel 
> - проблемы vla vlax 
> - и прочие непонятки с COM
> 
> зарегистрировать COM сервер nanoCAD\
> открываем командную строку
>
> на примере СПДС, для других модулей аналогично\
>  выполняем команду
> ```bat
> "d:\ProgFiles\Nanosoft\nanoCAD x64 25.1\nCadS.exe" /register
> ```

> [!Note]
а что же делать с отсутствующей веткой `HKEY_LOCAL_MACHINE\SOFTWARE\Nanosoft\nanoCAD x64\25.1` \
воскликнет пытливый читатель?\
Да ничего ответит писатель, максимальный глюк и неудобство это то что нана будет неправильно показывать номер свой сборки в окне о программе ))


> [!IMPORTANT]
update 31.07.2025\
Специально проверил\
Свежеустановленную сборку переместил на другой диск, в другой каталог\
Все стартует запускается, как часы\
Думаю это не моя заслуга , а linux для простоты работы под вайном, нанокад  с легкостью ищет нужное вокруг себя по относительным путям

> [!Note]
> у nanoCAD все уже есть для того что бы стать полноценным портабле, но\
>  nanoCAD без путей не понимает где искать
> - `UserDataDir` -пользовательский каталог с настройками  
> - `CorpOptions.xml` - корпоративные настройки мультикад для платформы, СПДС и Механики
> - `LogFile` - куда вести лог
> - `ToolbarSettings` - настройки панелей, положение видимость и т.п.
> -`AppOptions.xml` - настройки мультикад для платформы, СПДС и Механики
>>  без `AppOptions.xml` крашится настройка оформления и все с ней связанное...
>> - подключение к БД
>> - масштабы
> >- возможно, что то еще
> 
> Поэтому приходится редактировать реестр

<a name="problems">

## Возможные проблемы и решения

### В nanoCAD не открываются настройки оформления, в списке масштабов странное число...

скорей всего не загрузился  `AppOptions.xml`\
Причин всего две нет записи в реестре с путем к этому файлу \
на примере СПДС\
этой записи нет:
```reg
[HKEY_CURRENT_USER\SOFTWARE\Nanosoft\nanoCAD x64\25.1\NanoSPDS\MCSParams]
"SPDS.AppOptions_ru-RU"="D:\\setup\\nCAD\\SPDS.AppOptionsNana.xml"
```
Запись в реестре есть, нет файла по этому пути\
Проверку рекомендую начать с реестра, если параметра нет, \
то создаем строковый параметр со значением путь до реального файла AppOptions.xml\
 \
 Если нет файла `AppOptions.xml`, \
 взять этот файл и другие недостающие (например для СПДС) можно в `%ProgramData%\Nanosoft\nanoCAD x64 25.1\NanoSPDS\UserTemplates\ru-RU\`
